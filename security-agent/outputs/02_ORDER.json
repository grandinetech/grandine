{
  "metadata": {
    "target_folder": "transition_functions/",
    "static_callgraph": "NONE",
    "spec_loaded": true,
    "generated_at": "2025-01-06T12:00:00Z",
    "schema_version": "1.0.0",
    "review_rounds": 4
  },
  "audit_chunks": [
    {
      "chunk_title": "üö™ External entry points ‚Äî untrusted block & signature handlers",
      "rationale": "Primary attack surface for malicious blocks and signatures from network",
      "functions": [
        {"name": "untrusted_state_transition", "file": "src/combined.rs", "line": 56, "review_count": 1},
        {"name": "process_untrusted_block", "file": "src/combined.rs", "line": 623, "review_count": 1},
        {"name": "process_block_for_gossip", "file": "src/combined.rs", "line": 703},
        {"name": "process_untrusted_blinded_block", "file": "src/combined.rs", "line": 746, "review_count": 1},
        {"name": "process_block_header_for_gossip", "file": "src/unphased/block_processing.rs", "line": 76},
        {"name": "verify_base_signature_with_head_state", "file": "src/combined.rs", "line": 226, "review_count": 1}
      ]
    },
    {
      "chunk_title": "üîê Cryptographic signature verification",
      "rationale": "Critical authentication layer preventing unauthorized state changes",
      "functions": [
        {"name": "verify_signatures", "file": "src/combined.rs", "line": 259, "review_count": 1},
        {"name": "validate_proposer_slashing_with_verifier", "file": "src/unphased/block_processing.rs", "line": 251},
        {"name": "validate_attester_slashing_with_verifier", "file": "src/unphased/block_processing.rs", "line": 339},
        {"name": "validate_attestation_with_verifier", "file": "src/unphased/block_processing.rs", "line": 409},
        {"name": "validate_voluntary_exit_with_verifier", "file": "src/unphased/block_processing.rs", "line": 698},
        {"name": "validate_bls_to_execution_change_with_verifier", "file": "src/capella/block_processing.rs", "line": 386},
        {"name": "verify_sync_aggregate_signature", "file": "src/altair/block_processing.rs", "line": 592},
        {"name": "is_valid_deposit_signature", "file": "src/electra/epoch_processing.rs", "line": 341}
      ]
    },
    {
      "chunk_title": "‚ö†Ô∏è Slashing detection & punishment",
      "rationale": "Protocol security enforcement through economic penalties",
      "functions": [
        {"name": "validate_proposer_slashing", "file": "src/unphased/block_processing.rs", "line": 233},
        {"name": "validate_attester_slashing", "file": "src/unphased/block_processing.rs", "line": 322},
        {"name": "process_proposer_slashing", "file": "src/phase0/block_processing.rs", "line": 241},
        {"name": "process_attester_slashing", "file": "src/phase0/block_processing.rs", "line": 269},
        {"name": "process_slashings", "file": "src/phase0/epoch_processing.rs", "line": 141, "review_count": 1},
        {"name": "process_slashings_reset", "file": "src/unphased/epoch_processing.rs", "line": 182}
      ]
    },
    {
      "chunk_title": "üí∞ Deposit & withdrawal processing",
      "rationale": "Financial operations handling ETH movements between layers",
      "functions": [
        {"name": "validate_deposits", "file": "src/unphased/block_processing.rs", "line": 490},
        {"name": "verify_deposit_merkle_branch", "file": "src/unphased/block_processing.rs", "line": 642},
        {"name": "process_deposit_data", "file": "src/combined.rs", "line": 844, "review_count": 1},
        {"name": "apply_deposits", "file": "src/phase0/block_processing.rs", "line": 386},
        {"name": "process_deposit_request", "file": "src/electra/block_processing.rs", "line": 1185},
        {"name": "process_pending_deposits", "file": "src/electra/epoch_processing.rs", "line": 230},
        {"name": "apply_pending_deposit", "file": "src/electra/epoch_processing.rs", "line": 314},
        {"name": "process_withdrawals", "file": "src/capella/block_processing.rs", "line": 417},
        {"name": "get_expected_withdrawals", "file": "src/capella/block_processing.rs", "line": 498},
        {"name": "process_withdrawal_request", "file": "src/electra/block_processing.rs", "line": 1080},
        {"name": "process_withdrawals_root", "file": "src/capella/blinded_block_processing.rs", "line": 122}
      ]
    },
    {
      "chunk_title": "üîå Execution layer integration",
      "rationale": "Critical bridge between consensus and execution layers post-merge",
      "functions": [
        {"name": "process_execution_payload", "file": "src/bellatrix/block_processing.rs", "line": 157},
        {"name": "process_execution_payload_for_gossip", "file": "src/bellatrix/block_processing.rs", "line": 206},
        {"name": "process_execution_payload", "file": "src/capella/block_processing.rs", "line": 165},
        {"name": "process_execution_payload", "file": "src/deneb/block_processing.rs", "line": 161},
        {"name": "process_execution_payload", "file": "src/electra/block_processing.rs", "line": 452},
        {"name": "compute_source_address", "file": "src/electra/block_processing.rs", "line": 1372}
      ]
    },
    {
      "chunk_title": "üìú Attestation & voting validation",
      "rationale": "Consensus participation validation preventing finality attacks",
      "functions": [
        {"name": "validate_attestation", "file": "src/unphased/block_processing.rs", "line": 396},
        {"name": "apply_attestation", "file": "src/phase0/block_processing.rs", "line": 299},
        {"name": "apply_attestation", "file": "src/altair/block_processing.rs", "line": 319},
        {"name": "apply_attestation", "file": "src/electra/block_processing.rs", "line": 702},
        {"name": "validate_attestation_with_verifier", "file": "src/deneb/block_processing.rs", "line": 362},
        {"name": "validate_attestation_with_verifier", "file": "src/electra/block_processing.rs", "line": 761},
        {"name": "process_sync_aggregate", "file": "src/altair/block_processing.rs", "line": 527}
      ]
    },
    {
      "chunk_title": "‚öñÔ∏è Finality & justification",
      "rationale": "Core finality mechanism securing chain consensus",
      "functions": [
        {"name": "weigh_justification_and_finalization", "file": "src/unphased/epoch_processing.rs", "line": 217, "review_count": 1},
        {"name": "process_justification_and_finalization", "file": "src/combined.rs", "line": 465},
        {"name": "process_justification_and_finalization", "file": "src/phase0/epoch_processing.rs", "line": 125},
        {"name": "process_justification_and_finalization", "file": "src/altair/epoch_processing.rs", "line": 151},
        {"name": "should_process_justification_and_finalization", "file": "src/unphased/epoch_processing.rs", "line": 285}
      ]
    },
    {
      "chunk_title": "üîÑ Core state transitions",
      "rationale": "Central state machine coordinating all transition phases",
      "functions": [
        {"name": "custom_state_transition", "file": "src/combined.rs", "line": 119},
        {"name": "state_transition", "file": "src/phase0/state_transition.rs", "line": 26},
        {"name": "state_transition", "file": "src/altair/state_transition.rs", "line": 25},
        {"name": "state_transition", "file": "src/bellatrix/state_transition.rs", "line": 29},
        {"name": "state_transition", "file": "src/capella/state_transition.rs", "line": 30},
        {"name": "state_transition", "file": "src/deneb/state_transition.rs", "line": 30},
        {"name": "state_transition", "file": "src/electra/state_transition.rs", "line": 30},
        {"name": "trusted_state_transition", "file": "src/combined.rs", "line": 76},
        {"name": "state_transition_for_report", "file": "src/combined.rs", "line": 95}
      ]
    },
    {
      "chunk_title": "‚è∞ Slot & epoch processing",
      "rationale": "Time-based state progression and epoch transitions",
      "functions": [
        {"name": "process_slots", "file": "src/combined.rs", "line": 302},
        {"name": "process_slot", "file": "src/unphased/slot_processing.rs", "line": 31},
        {"name": "process_slots", "file": "src/phase0/slot_processing.rs", "line": 13},
        {"name": "process_slots", "file": "src/altair/slot_processing.rs", "line": 12},
        {"name": "process_slots", "file": "src/bellatrix/slot_processing.rs", "line": 12},
        {"name": "process_slots", "file": "src/capella/slot_processing.rs", "line": 12},
        {"name": "process_slots", "file": "src/deneb/slot_processing.rs", "line": 12},
        {"name": "process_slots", "file": "src/electra/slot_processing.rs", "line": 12}
      ]
    },
    {
      "chunk_title": "üèÜ Rewards & penalties calculation",
      "rationale": "Economic incentive calculations driving validator behavior",
      "functions": [
        {"name": "process_rewards_and_penalties", "file": "src/unphased/epoch_processing.rs", "line": 48},
        {"name": "should_process_rewards_and_penalties", "file": "src/unphased/epoch_processing.rs", "line": 294},
        {"name": "process_inactivity_updates", "file": "src/altair/epoch_processing.rs", "line": 167},
        {"name": "should_process_inactivity_updates", "file": "src/altair/epoch_processing.rs", "line": 290},
        {"name": "epoch_deltas", "file": "src/phase0/epoch_intermediates.rs", "line": 665},
        {"name": "epoch_deltas", "file": "src/altair/epoch_intermediates.rs", "line": 239}
      ]
    },
    {
      "chunk_title": "üìã Validator lifecycle management",
      "rationale": "Validator activation, exit and registry management",
      "functions": [
        {"name": "process_registry_updates", "file": "src/unphased/epoch_processing.rs", "line": 68},
        {"name": "process_registry_updates", "file": "src/deneb/epoch_processing.rs", "line": 141},
        {"name": "process_registry_updates", "file": "src/electra/epoch_processing.rs", "line": 163},
        {"name": "process_voluntary_exit", "file": "src/unphased/block_processing.rs", "line": 664},
        {"name": "validate_voluntary_exit", "file": "src/unphased/block_processing.rs", "line": 683},
        {"name": "process_voluntary_exit", "file": "src/electra/block_processing.rs", "line": 1020},
        {"name": "validate_voluntary_exit", "file": "src/electra/block_processing.rs", "line": 1039},
        {"name": "add_validator_to_registry", "file": "src/electra/block_processing.rs", "line": 897},
        {"name": "process_consolidation_request", "file": "src/electra/block_processing.rs", "line": 1215},
        {"name": "process_pending_consolidations", "file": "src/electra/epoch_processing.rs", "line": 366},
        {"name": "is_valid_switch_to_compounding_request", "file": "src/electra/block_processing.rs", "line": 1325}
      ]
    },
    {
      "chunk_title": "üé≤ RANDAO & randomness",
      "rationale": "Randomness generation for validator selection",
      "functions": [
        {"name": "process_randao", "file": "src/unphased/block_processing.rs", "line": 165},
        {"name": "process_randao_mixes_reset", "file": "src/unphased/epoch_processing.rs", "line": 189}
      ]
    },
    {
      "chunk_title": "üìä Epoch processing orchestration",
      "rationale": "High-level epoch transition coordination",
      "functions": [
        {"name": "process_epoch", "file": "src/combined.rs", "line": 496},
        {"name": "process_epoch", "file": "src/phase0/epoch_processing.rs", "line": 36},
        {"name": "process_epoch", "file": "src/altair/epoch_processing.rs", "line": 42},
        {"name": "process_epoch", "file": "src/bellatrix/epoch_processing.rs", "line": 25},
        {"name": "process_epoch", "file": "src/capella/epoch_processing.rs", "line": 22},
        {"name": "process_epoch", "file": "src/deneb/epoch_processing.rs", "line": 28},
        {"name": "process_epoch", "file": "src/electra/epoch_processing.rs", "line": 48},
        {"name": "epoch_report", "file": "src/combined.rs", "line": 511}
      ]
    },
    {
      "chunk_title": "üì¶ Block processing orchestration",
      "rationale": "High-level block processing coordination across phases",
      "functions": [
        {"name": "process_block", "file": "src/combined.rs", "line": 661},
        {"name": "custom_process_block", "file": "src/phase0/block_processing.rs", "line": 98},
        {"name": "custom_process_block", "file": "src/altair/block_processing.rs", "line": 114},
        {"name": "custom_process_block", "file": "src/bellatrix/block_processing.rs", "line": 105},
        {"name": "custom_process_block", "file": "src/capella/block_processing.rs", "line": 107},
        {"name": "custom_process_block", "file": "src/deneb/block_processing.rs", "line": 111},
        {"name": "custom_process_block", "file": "src/electra/block_processing.rs", "line": 151},
        {"name": "process_blinded_block", "file": "src/combined.rs", "line": 782},
        {"name": "process_trusted_block", "file": "src/combined.rs", "line": 644},
        {"name": "process_trusted_blinded_block", "file": "src/combined.rs", "line": 765}
      ]
    },
    {
      "chunk_title": "‚öôÔ∏è Block operations processing",
      "rationale": "Processing individual operations within blocks",
      "functions": [
        {"name": "process_operations", "file": "src/phase0/block_processing.rs", "line": 131},
        {"name": "process_operations", "file": "src/altair/block_processing.rs", "line": 151},
        {"name": "process_operations", "file": "src/bellatrix/block_processing.rs", "line": 228},
        {"name": "process_operations", "file": "src/capella/block_processing.rs", "line": 223},
        {"name": "process_operations", "file": "src/deneb/block_processing.rs", "line": 242},
        {"name": "process_operations", "file": "src/electra/block_processing.rs", "line": 507},
        {"name": "process_block_header", "file": "src/unphased/block_processing.rs", "line": 133},
        {"name": "process_eth1_data", "file": "src/unphased/block_processing.rs", "line": 208}
      ]
    },
    {
      "chunk_title": "üìà Effective balance updates",
      "rationale": "Balance adjustments affecting voting power",
      "functions": [
        {"name": "process_effective_balance_updates", "file": "src/unphased/epoch_processing.rs", "line": 152},
        {"name": "process_effective_balance_updates", "file": "src/electra/epoch_processing.rs", "line": 416}
      ]
    },
    {
      "chunk_title": "üîó BLS to execution changes",
      "rationale": "Credential changes for withdrawal addresses",
      "functions": [
        {"name": "process_bls_to_execution_change", "file": "src/capella/block_processing.rs", "line": 344},
        {"name": "validate_bls_to_execution_change", "file": "src/capella/block_processing.rs", "line": 371}
      ]
    },
    {
      "chunk_title": "üìú Historical data management",
      "rationale": "Managing historical roots and summaries",
      "functions": [
        {"name": "process_historical_roots_update", "file": "src/unphased/epoch_processing.rs", "line": 197},
        {"name": "process_historical_summaries_update", "file": "src/capella/epoch_processing.rs", "line": 134},
        {"name": "process_historical_summaries_update", "file": "src/deneb/epoch_processing.rs", "line": 216},
        {"name": "process_historical_summaries_update", "file": "src/electra/epoch_processing.rs", "line": 448}
      ]
    },
    {
      "chunk_title": "üîÑ Committee & participation updates",
      "rationale": "Validator committee assignments and participation tracking",
      "functions": [
        {"name": "process_participation_record_updates", "file": "src/phase0/epoch_processing.rs", "line": 194},
        {"name": "process_participation_flag_updates", "file": "src/altair/epoch_processing.rs", "line": 267},
        {"name": "process_sync_committee_updates", "file": "src/altair/epoch_processing.rs", "line": 275}
      ]
    },
    {
      "chunk_title": "üìë Phase-specific block processing",
      "rationale": "Phase-specific block handlers implementing unique logic",
      "functions": [
        {"name": "process_block", "file": "src/phase0/block_processing.rs", "line": 51},
        {"name": "process_block_for_gossip", "file": "src/phase0/block_processing.rs", "line": 78},
        {"name": "process_block", "file": "src/altair/block_processing.rs", "line": 65},
        {"name": "process_block_for_gossip", "file": "src/altair/block_processing.rs", "line": 92},
        {"name": "process_block", "file": "src/bellatrix/block_processing.rs", "line": 51},
        {"name": "process_block_for_gossip", "file": "src/bellatrix/block_processing.rs", "line": 79},
        {"name": "process_block", "file": "src/capella/block_processing.rs", "line": 57},
        {"name": "process_block_for_gossip", "file": "src/capella/block_processing.rs", "line": 85},
        {"name": "process_block", "file": "src/deneb/block_processing.rs", "line": 56},
        {"name": "process_block_for_gossip", "file": "src/deneb/block_processing.rs", "line": 84},
        {"name": "process_block", "file": "src/electra/block_processing.rs", "line": 94},
        {"name": "process_block_for_gossip", "file": "src/electra/block_processing.rs", "line": 122}
      ]
    },
    {
      "chunk_title": "üéØ Blinded block processing",
      "rationale": "Processing blocks with hidden execution payloads",
      "functions": [
        {"name": "custom_process_blinded_block", "file": "src/bellatrix/blinded_block_processing.rs", "line": 20},
        {"name": "custom_process_blinded_block", "file": "src/capella/blinded_block_processing.rs", "line": 33},
        {"name": "custom_process_blinded_block", "file": "src/deneb/blinded_block_processing.rs", "line": 22},
        {"name": "custom_process_blinded_block", "file": "src/electra/blinded_block_processing.rs", "line": 35}
      ]
    },
    {
      "chunk_title": "üìä Validator statistics & reporting",
      "rationale": "Performance metrics and validator statistics calculation",
      "functions": [
        {"name": "statistics", "file": "src/combined.rs", "line": 878},
        {"name": "statistics", "file": "src/phase0/epoch_intermediates.rs", "line": 552},
        {"name": "statistics", "file": "src/altair/epoch_intermediates.rs", "line": 174},
        {"name": "epoch_report", "file": "src/phase0/epoch_processing.rs", "line": 73},
        {"name": "epoch_report", "file": "src/altair/epoch_processing.rs", "line": 93},
        {"name": "epoch_report", "file": "src/bellatrix/epoch_processing.rs", "line": 76},
        {"name": "epoch_report", "file": "src/capella/epoch_processing.rs", "line": 76},
        {"name": "epoch_report", "file": "src/deneb/epoch_processing.rs", "line": 83},
        {"name": "epoch_report", "file": "src/electra/epoch_processing.rs", "line": 105}
      ]
    },
    {
      "chunk_title": "üî¢ Signature counting",
      "rationale": "Signature requirement calculation for verification",
      "functions": [
        {"name": "count_required_signatures", "file": "src/phase0/block_processing.rs", "line": 122},
        {"name": "count_required_signatures", "file": "src/altair/block_processing.rs", "line": 147},
        {"name": "count_required_signatures", "file": "src/bellatrix/state_transition.rs", "line": 228},
        {"name": "count_required_signatures", "file": "src/capella/block_processing.rs", "line": 161},
        {"name": "count_required_signatures", "file": "src/deneb/block_processing.rs", "line": 107},
        {"name": "count_required_signatures", "file": "src/electra/block_processing.rs", "line": 147}
      ]
    },
    {
      "chunk_title": "üîÑ ETH1 data processing",
      "rationale": "Ethereum 1.x deposit contract interaction",
      "functions": [
        {"name": "process_eth1_data_reset", "file": "src/unphased/epoch_processing.rs", "line": 143}
      ]
    },
    {
      "chunk_title": "üõ†Ô∏è Helper functions & utilities",
      "rationale": "Supporting functions for state transition processing",
      "functions": [
        {"name": "process_slots_for_epoch_report", "file": "src/combined.rs", "line": 534},
        {"name": "post_process_slots_for_epoch_report", "file": "src/combined.rs", "line": 553},
        {"name": "verify_signatures", "file": "src/phase0/state_transition.rs", "line": 93},
        {"name": "verify_signatures", "file": "src/altair/state_transition.rs", "line": 90},
        {"name": "verify_signatures", "file": "src/bellatrix/state_transition.rs", "line": 94},
        {"name": "verify_signatures", "file": "src/capella/state_transition.rs", "line": 96},
        {"name": "verify_signatures", "file": "src/deneb/state_transition.rs", "line": 96},
        {"name": "verify_signatures", "file": "src/electra/state_transition.rs", "line": 82}
      ]
    }
  ],
  "top_attack_paths": [
    {
      "entry_function": "untrusted_state_transition",
      "sink_function": "weigh_justification_and_finalization",
      "risk_reason": "Malicious block could manipulate justification bits to force invalid finality, causing chain split"
    },
    {
      "entry_function": "process_block_for_gossip",
      "sink_function": "apply_deposits",
      "risk_reason": "Invalid deposit processing could allow unauthorized validator activation or balance manipulation"
    },
    {
      "entry_function": "validate_attestation_with_verifier",
      "sink_function": "process_rewards_and_penalties",
      "risk_reason": "Forged attestations could manipulate reward calculations, draining honest validators"
    },
    {
      "entry_function": "process_execution_payload",
      "sink_function": "process_withdrawals",
      "risk_reason": "Malicious execution payload could authorize invalid withdrawals from validator balances"
    },
    {
      "entry_function": "validate_proposer_slashing_with_verifier",
      "sink_function": "process_slashings",
      "risk_reason": "False slashing evidence could wrongfully penalize honest validators"
    }
  ],
  "ordering_strategy": "Breadth-first from untrusted boundaries inward, guided by call-graph depth and STRIDE-like risk categories (S,T,R,I,D,E)."
}